{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent as _defineComponent } from 'vue';\nimport { o as _o, gei as _gei, sei as _sei } from \"vue\";\nimport _imports_0 from '/static/images/logo.png';\nimport { postLoginAPI, postLoginWxMinAPI, postLoginWxMinSimpleAPI } from '../../services/login';\nimport { useMemberStore } from '../../stores';\nimport {} from '../../types/member';\nimport { onLoad } from '@dcloudio/uni-app';\nimport { ref } from 'vue';\n// 获取 code 登录凭证\nexport default /*#__PURE__*/ _defineComponent(new UTSJSONObject({\n    __name: 'login',\n    setup(__props) {\n        let code = '';\n        onLoad(() => { return __awaiter(this, void 0, void 0, function* () {\n            const res = yield wx.login();\n            code = res.code;\n        }); });\n        // 获取用户手机号码\n        const onGetphonenumber = (ev = null) => { return __awaiter(this, void 0, void 0, function* () {\n            yield checkedAgreePrivacy();\n            const _a = ev.detail, encryptedData = _a.encryptedData, iv = _a.iv;\n            const res = yield postLoginWxMinAPI({ code, encryptedData, iv });\n            loginSuccess(res.result);\n        }); };\n        // 表单数据\n        const form = ref(new UTSJSONObject({\n            account: '',\n            password: ''\n        }));\n        // 表单提交\n        const onSubmit = () => { return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // 表单验证\n                if (!form.value.account || !form.value.password) {\n                    uni.showToast({\n                        icon: 'none',\n                        title: '请输入账号和密码'\n                    });\n                    return Promise.resolve(null);\n                }\n                uni.__f__('log', 'at pages/login/login.uvue:75', '开始登录...');\n                // 直接登录成功\n                const profile = {\n                    id: '1',\n                    account: form.value.account,\n                    avatar: '/static/images/avatar.png',\n                    nickname: '测试用户',\n                    gender: 1,\n                    birthday: '1990-01-01',\n                    cityCode: '110100',\n                    provinceCode: '110000',\n                    profession: '工程师'\n                };\n                uni.__f__('log', 'at pages/login/login.uvue:90', '创建用户信息成功:', profile);\n                // 保存会员信息\n                const memberStore = useMemberStore();\n                memberStore.setProfile(profile);\n                uni.__f__('log', 'at pages/login/login.uvue:96', '保存用户信息成功');\n                // 成功提示\n                uni.showToast({ icon: 'success', title: '登录成功' });\n                uni.__f__('log', 'at pages/login/login.uvue:101', '准备跳转到首页...');\n                // 直接跳转\n                uni.switchTab({\n                    url: '/pages/index/index',\n                    success: () => {\n                        uni.__f__('log', 'at pages/login/login.uvue:107', '跳转成功');\n                    },\n                    fail: (err) => {\n                        uni.__f__('error', 'at pages/login/login.uvue:110', '跳转失败:', err);\n                    }\n                });\n            }\n            catch (error) {\n                uni.__f__('error', 'at pages/login/login.uvue:114', '登录过程出错:', error);\n                uni.showToast({\n                    icon: 'none',\n                    title: '登录失败，请重试'\n                });\n            }\n        }); };\n        // 模拟手机号码快捷登录（开发练习）\n        const onGetphonenumberSimple = () => { return __awaiter(this, void 0, void 0, function* () {\n            // 直接登录成功\n            const profile = {\n                id: '1',\n                account: '13123456789',\n                avatar: '/static/images/avatar.png',\n                nickname: '测试用户',\n                gender: 1,\n                birthday: '1990-01-01',\n                cityCode: '110100',\n                provinceCode: '110000',\n                profession: '工程师'\n            };\n            // 保存会员信息\n            const memberStore = useMemberStore();\n            memberStore.setProfile(profile);\n            // 成功提示\n            uni.showToast({ icon: 'success', title: '登录成功' });\n            // 直接跳转\n            uni.switchTab({\n                url: '/pages/index/index'\n            });\n        }); };\n        // 请先阅读并勾选协议\n        const isAgreePrivacy = ref(false);\n        const isAgreePrivacyShakeY = ref(false);\n        const checkedAgreePrivacy = () => { return __awaiter(this, void 0, void 0, function* () {\n            if (!isAgreePrivacy.value) {\n                uni.showToast({\n                    icon: 'none',\n                    title: '请先阅读并勾选协议',\n                });\n                // 震动提示\n                isAgreePrivacyShakeY.value = true;\n                setTimeout(() => {\n                    isAgreePrivacyShakeY.value = false;\n                }, 500);\n                // 返回错误\n                return Promise.reject(new Error('请先阅读并勾选协议'));\n            }\n        }); };\n        const onOpenPrivacyContract = () => {\n            // 跳转至隐私协议页面\n            wx.openPrivacyContract(new UTSJSONObject({}));\n        };\n        return (_ctx = null, _cache = null) => {\n            const __returned__ = {\n                a: _imports_0,\n                b: form.value.account,\n                c: _o(($event = null) => { return form.value.account = $event.detail.value; }),\n                d: form.value.password,\n                e: _o(($event = null) => { return form.value.password = $event.detail.value; }),\n                f: _o(onSubmit),\n                g: _o(onGetphonenumberSimple),\n                h: _sei(_gei(_ctx, ''), 'view')\n            };\n            return __returned__;\n        };\n    }\n}));\n//# sourceMappingURL=C:/Users/FeiFan/Desktop/HealthCareApp/pages/login/login.uvue?vue&type=script&setup=true&lang.uts.js.map","references":["C:/Users/FeiFan/Desktop/My.ff/my.Software/HBuilderX.3.98.2023112510/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","C:/Users/FeiFan/Desktop/My.ff/my.Software/HBuilderX.3.98.2023112510/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","C:/Users/FeiFan/Desktop/HealthCareApp/services/login.ts","C:/Users/FeiFan/Desktop/HealthCareApp/stores/index.ts","C:/Users/FeiFan/Desktop/HealthCareApp/types/member.ts","C:/Users/FeiFan/Desktop/My.ff/my.Software/HBuilderX.3.98.2023112510/HBuilderX/plugins/uniapp-uts-v1/node_modules/@dcloudio/uni-uts-v1/lib/tsconfig/types/dcloudio__uni-app/types/index.d.ts","C:/Users/FeiFan/Desktop/My.ff/my.Software/HBuilderX.3.98.2023112510/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts"],"uniExtApis":["uni.showToast","uni.__f__","uni.switchTab"],"map":"{\"version\":3,\"file\":\"login.uvue?vue&type=script&setup=true&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"login.uvue?vue&type=script&setup=true&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
